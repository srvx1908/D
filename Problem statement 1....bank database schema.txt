Problem statement 1. 
 
Consider following Bank database schema and solve given queries:
Account(Acc_no, branch_name,balance)           branch(branch_name,branch_city, assets)
customer(cust_name,cust_street,cust_city)        Depositor(cust_name,acc_no)
Loan(loan_no,branch_name,amount)                 Borrower(cust_name,loan_no)

Q.1 Create above tables with appropriate constraints like primary key, foreign key, not null etc. with suitable data
Q.2. Create synonym for customer table as cust.
Q.3 Add customer phone number in Customer table.
Q.4 Delete phone number attribute from Customer table.
Q.5. Find the names of all branches in loan relation.
Q.6. Find all customers who have a loan from bank. Find their names,loan_no and loan amount.     
Q.7. List all customers in alphabetical order who have loan from Akurdi branch.
Q.8. Find average account balance at Akurdi branch.
Q.9. Find no. of depositors at each branch.



Q.1 Create above tables with appropriate constraints

CREATE TABLE Branch (
    branch_name VARCHAR(50) PRIMARY KEY,
    branch_city VARCHAR(50) NOT NULL,
    assets DECIMAL(15,2)
);

CREATE TABLE Account (
    acc_no INT PRIMARY KEY,
    branch_name VARCHAR(50),
    balance DECIMAL(15,2) CHECK (balance >= 0),
    FOREIGN KEY (branch_name) REFERENCES Branch(branch_name)
);

CREATE TABLE Customer (
    cust_name VARCHAR(50) PRIMARY KEY,
    cust_street VARCHAR(100) NOT NULL,
    cust_city VARCHAR(50) NOT NULL
);

CREATE TABLE Depositor (
    cust_name VARCHAR(50),
    acc_no INT,
    PRIMARY KEY (cust_name, acc_no),
    FOREIGN KEY (cust_name) REFERENCES Customer(cust_name),
    FOREIGN KEY (acc_no) REFERENCES Account(acc_no)
);

CREATE TABLE Loan (
    loan_no INT PRIMARY KEY,
    branch_name VARCHAR(50),
    amount DECIMAL(15,2) CHECK (amount > 0),
    FOREIGN KEY (branch_name) REFERENCES Branch(branch_name)
);

CREATE TABLE Borrower (
    cust_name VARCHAR(50),
    loan_no INT,
    PRIMARY KEY (cust_name, loan_no),

    FOREIGN KEY (cust_name) REFERENCES Customer(cust_name),
    FOREIGN KEY (loan_no) REFERENCES Loan(loan_no)
);

Example sample data

INSERT INTO Branch VALUES ('Akurdi', 'Pune', 5000000);
INSERT INTO Branch VALUES ('Nigdi', 'Pune', 3000000);

INSERT INTO Account VALUES (101, 'Akurdi', 45000);
INSERT INTO Account VALUES (102, 'Akurdi', 60000);
INSERT INTO Account VALUES (103, 'Nigdi', 25000);

INSERT INTO Customer VALUES ('Sujit', 'Main Street', 'Pune');
INSERT INTO Customer VALUES ('Rohit', 'MG Road', 'Pune');
INSERT INTO Customer VALUES ('Priya', 'Station Road', 'Mumbai');

INSERT INTO Depositor VALUES ('Sujit', 101);
INSERT INTO Depositor VALUES ('Rohit', 102);
INSERT INTO Depositor VALUES ('Priya', 103);

INSERT INTO Loan VALUES (201, 'Akurdi', 200000);
INSERT INTO Loan VALUES (202, 'Nigdi', 150000);

INSERT INTO Borrower VALUES ('Sujit', 201);
INSERT INTO Borrower VALUES ('Priya', 202);

Q.2 Create synonym for customer table as cust
 
CREATE SYNONYM cust FOR Customer;
   or
CREATE VIEW cust AS SELECT * FROM Customer;

Q.3 Add customer phone number in Customer table

ALTER TABLE Customer
ADD phone_no VARCHAR(15);

Q.4 Delete phone number attribute from Customer table 

ALTER TABLE Customer
DROP COLUMN phone_no;

Q.5. Find the names of all branches in loan relation.

SELECT DISTINCT branch_name
FROM Loan;


Q.6. Find all customers who have a loan from bank. Find their names,loan_no and loan amount.

SELECT B.cust_name, L.loan_no, L.amount
FROM Borrower B
JOIN Loan L ON B.loan_no = L.loan_no;


Q.7. List all customers in alphabetical order who have loan from Akurdi branch.

SELECT DISTINCT C.cust_name
FROM Customer C
JOIN Borrower B ON C.cust_name = B.cust_name
JOIN Loan L ON B.loan_no = L.loan_no
WHERE L.branch_name = 'Akurdi'
ORDER BY C.cust_name ASC;


Q.8. Find average account balance at Akurdi branch.

SELECT AVG(balance) AS avg_balance
FROM Account
WHERE branch_name = 'Akurdi';

Q.9. Find no. of depositors at each branch.

SELECT A.branch_name, COUNT(DISTINCT D.cust_name) AS no_of_depositors
FROM Account A
JOIN Depositor D ON A.acc_no = D.acc_no
GROUP BY A.branch_name;
