Problem statement 9 

Write a database trigger on Library table. The System should keep track of the records that are being updated or deleted. The old value of updated or deleted records should be added in Library_Audit table.



âœ… Step 1: Create Main Table

CREATE TABLE Library (
    BookID INT PRIMARY KEY,
    Title VARCHAR(100),
    Author VARCHAR(50),
    Price DECIMAL(8,2)
);



âœ… Step 2: Create Audit Table

CREATE TABLE Library_Audit (
    AuditID INT AUTO_INCREMENT PRIMARY KEY,
    BookID INT,
    Title VARCHAR(100),
    Author VARCHAR(50),
    Price DECIMAL(8,2),
    ActionType VARCHAR(10),
    ActionDate DATETIME
);



âœ… Step 3: Create Trigger for UPDATE

DELIMITER $$

CREATE TRIGGER trg_Library_Update
BEFORE UPDATE ON Library
FOR EACH ROW
BEGIN
    INSERT INTO Library_Audit (BookID, Title, Author, Price, ActionType, ActionDate)
    VALUES (OLD.BookID, OLD.Title, OLD.Author, OLD.Price, 'UPDATE', NOW());
END $$

DELIMITER ;



âœ… Step 4: Create Trigger for DELETE

DELIMITER $$

CREATE TRIGGER trg_Library_Delete
BEFORE DELETE ON Library
FOR EACH ROW
BEGIN
    INSERT INTO Library_Audit (BookID, Title, Author, Price, ActionType, ActionDate)
    VALUES (OLD.BookID, OLD.Title, OLD.Author, OLD.Price, 'DELETE', NOW());
END $$

DELIMITER ;



âœ… Step 5: Test the Trigger
Insert sample data:

INSERT INTO Library VALUES 
(1, 'Database Systems', 'Navathe', 550.00),
(2, 'Operating Systems', 'Silberschatz', 620.00);



Update a record:

UPDATE Library 
SET Price = 600.00 
WHERE BookID = 1;



Delete a record:

DELETE FROM Library 
WHERE BookID = 2;



âœ… Step 6: Check Audit Table

SELECT * FROM Library_Audit;






TRIGGER:::::

ðŸ’¡ Definition of a Trigger

A trigger is a special kind of stored program that automatically executes in response to a specific event on a table or view, such as an INSERT, UPDATE, or DELETE.

In simple words:

ðŸ”” A trigger is like an alarm or automatic reaction â€” it "fires" when something happens in a table.

ðŸ§  Why We Use Triggers

Triggers are used to:

Maintain data integrity automatically

Audit changes made to a table (track updates/deletes)

Enforce business rules

Prevent invalid transactions

Replicate data between tables

