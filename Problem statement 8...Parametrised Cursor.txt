Problem statement 8 

Write a PL/SQL block of code using parameterized Cursor that will merge the data available in the newly created table N_RollCall with the data available in the table O_RollCall. If the data in the first table already exist in the second table then that data should be skipped. 





✅ Step 1: Create Tables


CREATE TABLE O_RollCall (
    RollNo INT PRIMARY KEY,
    Name   VARCHAR(50),
    Dept   VARCHAR(30)
);

CREATE TABLE N_RollCall (
    RollNo INT,
    Name   VARCHAR(50),
    Dept   VARCHAR(30)
);


2️⃣ Insert Sample Data

-- Old RollCall (Existing Data)
INSERT INTO O_RollCall VALUES (101, 'Ravi', 'Computer');
INSERT INTO O_RollCall VALUES (102, 'Priya', 'IT');
INSERT INTO O_RollCall VALUES (103, 'Suresh', 'Mechanical');

-- New RollCall (Some Duplicate + Some New)
INSERT INTO N_RollCall VALUES (102, 'Priya', 'IT');       -- duplicate
INSERT INTO N_RollCall VALUES (104, 'Anita', 'Computer'); -- new
INSERT INTO N_RollCall VALUES (105, 'Rahul', 'Civil');    -- new



3️⃣ Stored Procedure (MySQL Version — Parameterized Cursor Simulation)


DELIMITER $$

CREATE PROCEDURE merge_rollcall()
BEGIN
    DECLARE done INT DEFAULT 0;
    DECLARE v_roll INT;
    DECLARE v_name VARCHAR(50);
    DECLARE v_dept VARCHAR(30);
    DECLARE v_exists INT;

    -- Cursor for new roll call table
    DECLARE cur CURSOR FOR 
        SELECT RollNo, Name, Dept FROM N_RollCall;

    DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = 1;

    OPEN cur;

    read_loop: LOOP
        FETCH cur INTO v_roll, v_name, v_dept;
        IF done = 1 THEN
            LEAVE read_loop;
        END IF;

        -- Check if RollNo already exists in old table
        SELECT COUNT(*) INTO v_exists 
        FROM O_RollCall
        WHERE RollNo = v_roll;

        -- If not exists, insert it
        IF v_exists = 0 THEN
            INSERT INTO O_RollCall VALUES (v_roll, v_name, v_dept);
        END IF;
    END LOOP;

    CLOSE cur;
END $$

DELIMITER ;



4️⃣ Execute Procedure

CALL merge_rollcall();



5️⃣ View Final Result

SELECT * FROM O_RollCall;




{{A parameterized cursor in PL/SQL is a cursor that takes input values (parameters) at runtime, making it more flexible and dynamic than a normal cursor.}}